<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pulse — A Minimal Blog (Tech / Health / Finance)</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#94a3b8; --accent:#7c3aed; --glass: rgba(255,255,255,0.03);
      --radius:12px; --max-width:1100px;
    }
    *{box-sizing:border-box}
    body{font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; background:linear-gradient(180deg,#071024 0%, #071730 100%); color:#e6eef8; -webkit-font-smoothing:antialiased}
    .wrap{max-width:var(--max-width);margin:36px auto;padding:20px}
    header{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#06b6d4);display:flex;align-items:center;justify-content:center;font-weight:700;color:white}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted)}

    main{display:grid;grid-template-columns: 1fr 320px; gap:20px;margin-top:20px}

    .controls{display:flex;gap:8px;align-items:center}
    .search{background:var(--glass);border:1px solid rgba(255,255,255,0.03);padding:10px 12px;border-radius:10px;min-width:220px;color:inherit}
    .chip{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:6px 10px;border-radius:999px;font-size:13px;color:var(--muted)}

    .posts{display:flex;flex-direction:column;gap:16px}
    .post{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:18px;border-radius:var(--radius);box-shadow:0 6px 18px rgba(2,6,23,0.6);}
    .post .meta{display:flex;gap:12px;align-items:center;color:var(--muted);font-size:13px;margin-bottom:8px}
    .post h2{margin:0 0 8px 0}
    .excerpt{color:var(--muted);margin-bottom:10px}
    .post .tags{display:flex;gap:8px;flex-wrap:wrap}
    .tag{background:rgba(255,255,255,0.03);padding:6px 8px;border-radius:8px;font-size:12px;color:var(--muted);cursor:pointer}

    .sidebar{position:relative}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);padding:16px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .section{margin-bottom:16px}
    .section h3{margin:0 0 8px 0;font-size:14px}
    .cat{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;cursor:pointer}
    .cat:hover{background:rgba(255,255,255,0.01)}
    .tag-cloud{display:flex;gap:8px;flex-wrap:wrap}

    .post-full{margin-top:12px}
    .comments{margin-top:12px;border-top:1px dashed rgba(255,255,255,0.03);padding-top:12px}
    .comment{padding:10px;border-radius:8px;margin-bottom:8px;background:rgba(0,0,0,0.2)}
    .comment small{color:var(--muted)}

    .btn{background:var(--accent);border:none;color:white;padding:8px 10px;border-radius:8px;cursor:pointer}
    input,textarea,select{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:inherit;width:100%}

    footer{margin-top:26px;color:var(--muted);font-size:13px;text-align:center}

    @media (max-width:900px){main{grid-template-columns:1fr} .sidebar{order:2}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="logo">P</div>
        <div>
          <h1>Pulse</h1>
          <p class="lead">A minimal starter blog — Tech · Health · Finance</p>
        </div>
      </div>
      <div class="controls">
        <input class="search" id="q" placeholder="Search posts, tags, authors..." aria-label="Search posts">
        <div class="chip" id="clearFilters">Reset</div>
      </div>
    </header>

    <main>
      <section>
        <div id="posts" class="posts" aria-live="polite"></div>
      </section>

      <aside class="sidebar">
        <div class="card">
          <div class="section">
            <h3>Categories</h3>
            <div id="categories"></div>
          </div>
          <div class="section">
            <h3>Tags</h3>
            <div class="tag-cloud" id="tags"></div>
          </div>
          <div class="section">
            <h3>Create Post (demo)</h3>
            <form id="postForm">
              <input id="title" placeholder="Title" required>
              <select id="category">
                <option value="Tech">Tech</option>
                <option value="Health">Health</option>
                <option value="Finance">Finance</option>
              </select>
              <input id="tagsInput" placeholder="tags comma separated">
              <textarea id="content" rows="3" placeholder="Short excerpt..." required></textarea>
              <button class="btn" type="submit">Add Post</button>
            </form>
          </div>
        </div>
      </aside>
    </main>

    <footer>
      Built with ❤️ — this is a client-only demo. Comments are stored locally in your browser.
    </footer>
  </div>

  <script>
    // --- demo data ---
    const STORAGE_KEY = 'pulse_blog_v1';

    const samplePosts = [
      {id: genId(), title:'Why JavaScript Still Rules the Web', category:'Tech', tags:['javascript','web','frontend'], excerpt:'A short look at modern JS trends: frameworks, tooling, and runtime innovations.', content:'Full content here...'},
      {id: genId(), title:'5 Habits for Better Mental Health', category:'Health', tags:['wellness','habits'], excerpt:'Tiny daily choices that compound into better mental health.', content:'Full content here...'},
      {id: genId(), title:'Understanding Index Funds', category:'Finance', tags:['investing','funds'], excerpt:'Why low-cost index funds are the go-to for many long-term investors.', content:'Full content here...'},
    ];

    // load or initialize store
    let store = (function(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(raw) return JSON.parse(raw);
      const init = {posts: samplePosts, comments: {}};
      localStorage.setItem(STORAGE_KEY, JSON.stringify(init));
      return init;
    })();

    // --- helpers ---
    function save(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(store)); }
    function genId(){ return Math.random().toString(36).slice(2,9); }

    // --- rendering ---
    const postsEl = document.getElementById('posts');
    const categoriesEl = document.getElementById('categories');
    const tagsEl = document.getElementById('tags');
    const qEl = document.getElementById('q');

    function getAllTags(){ const set = new Set(); store.posts.forEach(p=>p.tags.forEach(t=>set.add(t))); return [...set]; }
    function getCategories(){ const counts = {}; store.posts.forEach(p=>counts[p.category] = (counts[p.category]||0)+1); return counts; }

    function renderSidebar(){
      const cats = getCategories();
      categoriesEl.innerHTML = '';
      Object.keys(cats).forEach(cat=>{
        const el = document.createElement('div'); el.className='cat'; el.tabIndex=0;
        el.innerHTML = `<span>${cat}</span><small class="pill">${cats[cat]}</small>`;
        el.onclick = ()=> filterBy({category:cat});
        categoriesEl.appendChild(el);
      });
      tagsEl.innerHTML = '';
      getAllTags().forEach(t=>{
        const b = document.createElement('div'); b.className='tag'; b.textContent = t; b.onclick = ()=> filterBy({tag:t});
        tagsEl.appendChild(b);
      });
    }

    function renderPosts(list){
      postsEl.innerHTML = '';
      if(!list.length) { postsEl.innerHTML = '<p style="color:var(--muted)">No posts found.</p>'; return }
      list.forEach(p=>{
        const node = document.createElement('article'); node.className='post';
        node.innerHTML = `
          <div class="meta"><span>${p.category}</span><span>•</span><small>${p.tags.join(', ')}</small></div>
          <h2>${escapeHtml(p.title)}</h2>
          <p class="excerpt">${escapeHtml(p.excerpt)}</p>
          <div class="tags">${p.tags.map(t=>`<div class="tag" data-tag="${t}">${t}</div>`).join('')}</div>
          <div class="post-full" id="full-${p.id}" aria-hidden="true" style="display:none;">
            <div style="margin-top:10px;color:var(--muted)">${escapeHtml(p.content)}</div>
            <div class="comments" id="comments-${p.id}"></div>
            <form data-post="${p.id}" class="commentForm" style="margin-top:10px;display:grid;gap:8px;">
              <input name="name" placeholder="Your name" required>
              <textarea name="text" placeholder="Add a comment" rows="3" required></textarea>
              <div style="display:flex;gap:8px"><button class="btn" type="submit">Comment</button><button type="button" class="chip" data-cancel="${p.id}">Close</button></div>
            </form>
          </div>
          <div style="margin-top:10px;display:flex;gap:8px;align-items:center"><button class="chip" data-open="${p.id}">Read / Comment</button></div>
        `;

        postsEl.appendChild(node);
      });

      // delegate tag click
      document.querySelectorAll('.post .tag').forEach(el=> el.addEventListener('click', e=> filterBy({tag: e.target.dataset.tag})));

      // open/close
      document.querySelectorAll('[data-open]').forEach(btn=> btn.onclick = ()=> showFull(btn.dataset.open));
      document.querySelectorAll('[data-cancel]').forEach(btn=> btn.onclick = ()=> closeFull(btn.dataset.cancel));

      // comment forms
      document.querySelectorAll('.commentForm').forEach(f=>{
        f.onsubmit = e=>{
          e.preventDefault();
          const id = f.dataset.post; const name = f.name.value.trim(); const text = f.text.value.trim();
          if(!name||!text) return;
          const comment = {id:genId(),name, text, time: new Date().toISOString()};
          store.comments[id] = store.comments[id]||[]; store.comments[id].push(comment); save(); renderComments(id);
          f.reset();
        }
      });

    }

    function showFull(id){ document.getElementById('full-'+id).style.display='block'; document.getElementById('full-'+id).ariaHidden='false'; renderComments(id); }
    function closeFull(id){ document.getElementById('full-'+id).style.display='none'; document.getElementById('full-'+id).ariaHidden='true'; }

    function renderComments(postId){
      const container = document.getElementById('comments-'+postId);
      const list = store.comments[postId] || [];
      container.innerHTML = '<h4 style="margin:0 0 8px 0">Comments</h4>' + (list.length? list.map(c=>`<div class="comment"><strong>${escapeHtml(c.name)}</strong> <small>${new Date(c.time).toLocaleString()}</small><div style="margin-top:6px">${escapeHtml(c.text)}</div><div style="margin-top:6px"><button class=\"chip\" data-del=\"${postId}|${c.id}\">Delete</button></div></div>`).join('') : '<p style="color:var(--muted)">No comments yet.</p>');
      // wire delete
      container.querySelectorAll('[data-del]').forEach(b=> b.onclick = ()=>{
        const [pid,cid] = b.dataset.del.split('|'); store.comments[pid] = (store.comments[pid]||[]).filter(x=> x.id!==cid); save(); renderComments(pid);
      });
    }

    // --- filters ---
    let activeFilters = {};

    function filterBy({category, tag, q} = {}){
      if(category !== undefined) { activeFilters.category = category; qEl.value = '' }
      if(tag !== undefined) { activeFilters.tag = tag; qEl.value = '' }
      if(q !== undefined) { activeFilters.q = q }
      applyFilters();
    }

    function applyFilters(){
      let list = [...store.posts];
      if(activeFilters.category) list = list.filter(p=> p.category === activeFilters.category);
      if(activeFilters.tag) list = list.filter(p=> p.tags.includes(activeFilters.tag));
      if(qEl.value.trim()){ const q = qEl.value.toLowerCase(); list = list.filter(p=> (p.title+p.excerpt+p.tags.join(' ')).toLowerCase().includes(q)); }
      renderPosts(list);
      renderSidebar();
    }

    document.getElementById('clearFilters').onclick = ()=>{ activeFilters={}; qEl.value=''; applyFilters(); }
    qEl.oninput = ()=> { activeFilters.q = qEl.value; applyFilters(); }

    // --- create post demo ---
    document.getElementById('postForm').onsubmit = e=>{
      e.preventDefault();
      const t = document.getElementById('title').value.trim();
      const c = document.getElementById('category').value; const tags = document.getElementById('tagsInput').value.split(',').map(x=>x.trim()).filter(Boolean);
      const excerpt = document.getElementById('content').value.trim();
      const post = {id:genId(), title:t, category:c, tags, excerpt, content:excerpt};
      store.posts.unshift(post); save(); renderSidebar(); applyFilters(); e.target.reset();
    }

    // --- utilities ---
    function escapeHtml(s){ return (s+'').replace(/[&"'<>]/g, c => ({'&':'&amp;','"':'&quot;',"'":'&#39;','<':'&lt;','>':'&gt;'}[c])); }

    // initial render
    renderSidebar(); applyFilters();

    // accessibility: keyboard category selection
    categoriesEl.addEventListener('keydown', e=>{ if(e.key === 'Enter' || e.key === ' ') e.target.click(); })

    // small feature: delete all data (dev)
    window.__pulse = {reset:()=>{localStorage.removeItem(STORAGE_KEY); location.reload();}}
  </script>
</body>
</html>
